spec:
  template:
    metadata:
      labels:
        role: influxdb
    spec:
      volumes:
      - name: influxdb-storage
        emptyDir: {}
      containers:
      - image: influxdb:${influxdb.version}
        name: eclipsehono-influxdb
        volumeMounts:
        - name: influxdb-storage
          mountPath: /var/lib/influxdb
        env:
        - name: INFLUXDB_GRAPHITE_0_ENABLED
          value: true
        - name: INFLUXDB_GRAPHITE_0_TEMPLATES
          value: "*.counter.hono.messaging.receivers.upstream.links.* host.measurement.measurement.measurement.measurement.measurement.measurement.type.tenant.measurement*, *.counter.hono.messaging.senders.downstream.* host.measurement.measurement.measurement.measurement.measurement.type.tenant.measurement*, *.gauge.hono.messaging.link.downstream.credits.* host.measurement.measurement.measurement.measurement.measurement.measurement.type.tenant, *.counter.hono.messaging.messages.* host.measurement.measurement.measurement.measurement.type.tenant.measurement*, *.meter.hono.messaging.messages.* host.measurement.measurement.measurement.measurement.type.tenant.measurement*, host.measurement*"
        - name: INFLUXDB_ADMIN_ENABLED
          value: true
        ports:
        - containerPort: "8086"
          name: api
          protocol: TCP
        - containerPort: "8083"
          name: admin
          protocol: TCP
        - containerPort: "2003"
          name: graphite
          protocol: TCP
        readinessProbe:
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 1
          tcpSocket:
            port: 2003
        livenessProbe:
          initialDelaySeconds: 20
          periodSeconds: 9
          timeoutSeconds: 1
          tcpSocket:
            port: 2003
