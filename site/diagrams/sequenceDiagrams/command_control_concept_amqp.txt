participant Device
participant AMQP Adapter
participant Application

note over Device
The device is connected and
authenticated with TENANT/4711
end note over
Device->AMQP Adapter: 1. attach("receiver", "command")
AMQP Adapter->Device: 2. attach("sender", "command")
AMQP Adapter->Application: 3. transfer("event/TENANT","4711","ttd=-1")
activate Application
Application->AMQP Adapter: 4. transfer("command/TENANT/4711","light","ON")
note over AMQP Adapter
The command message is sent to the
device with the 'reply-to' property set to
"command_response/TENANT/4711/${replyId}"
end note over
AMQP Adapter->Device: 5. transfer("command/TENANT/4711","light","ON")
note over Device
In order to send back the
response, the device opens
an anonymous sender link
end note over
Device->AMQP Adapter: 6. attach("sender", null)
AMQP Adapter->Device: 7. attach("receiver", null)
Device->AMQP Adapter: 8. transfer("${reply-to}","status=200","lumen=100")
AMQP Adapter->Application: 9. transfer("${reply-to}","status=200","lumen=100")
deactivate Application
