title Protocol Adapter Device Authentication (success)

Device->+Protocol Adapter: authenticate(type, auth-id, secrets)
note over Device:
Denotes the process of authentication
(that differs for every protocol)
end note

Protocol Adapter->+Credentials Service: transfer("credentials/TENANT", "get", type, auth-id)
note over Credentials Service: lookup credentials
Credentials Service->-Protocol Adapter: transfer("credentials/TENANT", "200", credentials)

Protocol Adapter->Protocol Adapter: verify(credentials, secrets)
note over Protocol Adapter:
Verify retrieved credentials
against device secrets
(e.g. compare hashed passwords)
end note
Protocol Adapter->-Device: OK
