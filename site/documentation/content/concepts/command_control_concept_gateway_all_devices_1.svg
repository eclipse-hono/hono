<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="590.4px" preserveAspectRatio="none" style="width:1074px;height:590px;" version="1.1" viewBox="0 0 1074 590" width="1074px" zoomAndPan="magnify"><defs><filter height="300%" id="f3s3y7qbr2dv1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.4"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.8" dy="4.8" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="565.0219" style="stroke: #A80036; stroke-width: 1.2;" width="409.2" x="250.2" y="4.8"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="432" y="19.2803">Hono</text><rect fill="#FFFFFF" filter="url(#f3s3y7qbr2dv1)" height="225.5156" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="353.4" y="340.7063"/><rect fill="#FFFFFF" filter="url(#f3s3y7qbr2dv1)" height="120.6375" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="987" y="445.5844"/><rect fill="#FFFFFF" filter="url(#f3s3y7qbr2dv1)" height="261.8344" style="stroke: #000000; stroke-width: 2.4;" width="1041.6" x="19.2" y="193.35"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="136.8" x2="136.8" y1="89.6719" y2="577.0219"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="359.4" x2="359.4" y1="89.6719" y2="577.0219"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="564.6" x2="564.6" y1="89.6719" y2="577.0219"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="751.8" x2="751.8" y1="89.6719" y2="577.0219"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="992.4" x2="992.4" y1="89.6719" y2="577.0219"/><rect fill="#FEFECE" filter="url(#f3s3y7qbr2dv1)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="87.6" x="91.2" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="70.8" x="99.6" y="71.3098">Gateway</text><rect fill="#FEFECE" filter="url(#f3s3y7qbr2dv1)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="204" x="255" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="187.2" x="263.4" y="51.7535">Hono Protocol Adapter</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="86.4" x="313.8" y="71.3098">instance 1</text><rect fill="#FEFECE" filter="url(#f3s3y7qbr2dv1)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="174" x="475.8" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="157.2" x="484.2" y="51.7535">Device Connection</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="126" x="499.8" y="71.3098">API component</text><rect fill="#FEFECE" filter="url(#f3s3y7qbr2dv1)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="166.8" x="666.6" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="675" y="51.7535">AMQP messaging</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="716.4" y="71.3098">network</text><rect fill="#FEFECE" filter="url(#f3s3y7qbr2dv1)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="106.8" x="937.2" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="90" x="945.6" y="71.3098">Application</text><rect fill="#FFFFFF" filter="url(#f3s3y7qbr2dv1)" height="225.5156" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="353.4" y="340.7063"/><rect fill="#FFFFFF" filter="url(#f3s3y7qbr2dv1)" height="120.6375" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="987" y="445.5844"/><path d="M9.6,107.6719 L9.6,173.6719 L260.4,173.6719 L260.4,119.6719 L248.4,107.6719 L9.6,107.6719 " fill="#FBFB77" filter="url(#f3s3y7qbr2dv1)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M248.4,107.6719 L248.4,119.6719 L260.4,119.6719 L248.4,107.6719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="160.8" x="16.8" y="128.1521">The gateway 'gw-1' is</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="225.6" x="16.8" y="146.3115">connected and authenticated</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="136.8" x="16.8" y="164.4709">with TENANT/gw-1</text><path d="M19.2,193.35 L278.4,193.35 L278.4,201.75 L266.4,213.75 L19.2,213.75 L19.2,193.35 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="261.8344" style="stroke: #000000; stroke-width: 2.4;" width="1041.6" x="19.2" y="193.35"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="205.2" x="37.2" y="209.0303">Command subscription</text><path d="M31.2,219.9094 L31.2,285.9094 L238.8,285.9094 L238.8,231.9094 L226.8,219.9094 L31.2,219.9094 " fill="#FBFB77" filter="url(#f3s3y7qbr2dv1)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M226.8,219.9094 L226.8,231.9094 L238.8,231.9094 L226.8,219.9094 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="182.4" x="38.4" y="240.3896">The gateway subscribes</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="176.4" x="38.4" y="258.549">to commands just as a</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="156" x="38.4" y="276.7084">normal device would</text><polygon fill="#A80036" points="339,335.9063,351,340.7063,339,345.5062,343.8,340.7063" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="137.4" x2="346.2" y1="340.7063" y2="340.7063"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="145.8" y="325.5475">0</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="177.6" x="161.4" y="316.4678">Command subscription</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="102" x="166.2" y="334.6271">/ TTD request</text><polygon fill="#A80036" points="738,370.8656,750,375.6656,738,380.4656,742.8,375.6656" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="365.4" x2="745.2" y1="375.6656" y2="375.6656"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="373.8" y="369.5865">1</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="300" x="389.4" y="369.5865">attach("receiver", "command/TENANT")</text><polygon fill="#A80036" points="738,405.825,750,410.625,738,415.425,742.8,410.625" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="365.4" x2="745.2" y1="410.625" y2="410.625"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="373.8" y="404.5459">2</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="315.6" x="389.4" y="404.5459">attach("receiver", "control/TENANT/gw-1")</text><polygon fill="#A80036" points="972.6,440.7844,984.6,445.5844,972.6,450.3844,977.4,445.5844" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="365.4" x2="979.8" y1="445.5844" y2="445.5844"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="373.8" y="439.5053">3</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="583.2" x="389.4" y="439.5053">transfer("event/TENANT","gw-1","ttd=${ttd}")  via AMQP messaging network</text><path d="M72,469.5844 L72,553.5844 L628.8,553.5844 L628.8,481.5844 L616.8,469.5844 L72,469.5844 " fill="#FBFB77" filter="url(#f3s3y7qbr2dv1)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M616.8,469.5844 L616.8,481.5844 L628.8,481.5844 L616.8,469.5844 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="502.8" x="91.5" y="490.0646">In order for commands to be successfully mapped to the gateway</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="462" x="91.5" y="508.224">from here on, the gateway must have acted on behalf of the</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="465.6" x="91.5" y="526.3834">command target device (e.g. sent telemetry for it) or it must</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="364.8" x="91.5" y="544.5428">be the only gateway associated with the device.</text><!--MD5=[0e0adb0319001e8de4010f18d7c7ed35]
@startuml
scale 1.2
hide footbox

participant Gateway order 20
box "Hono"
    participant "Hono Protocol Adapter\ninstance 1" order 30
    participant "Device Connection\nAPI component" order 50
end box
participant "AMQP messaging \nnetwork" order 60
participant Application order 70

autonumber 0

note over Gateway
The gateway 'gw-1' is
connected and authenticated
with TENANT/gw-1
end note

group Command subscription
    note over Gateway
    The gateway subscribes
    to commands just as a
    normal device would
    end note
    Gateway -> "Hono Protocol Adapter\ninstance 1": Command subscription\n / TTD request
    activate "Hono Protocol Adapter\ninstance 1"

    "Hono Protocol Adapter\ninstance 1" -> "AMQP messaging \nnetwork": attach("receiver", "command/TENANT")
    "Hono Protocol Adapter\ninstance 1" -> "AMQP messaging \nnetwork": attach("receiver", "control/TENANT/gw-1")

    "Hono Protocol Adapter\ninstance 1" -> Application: transfer("event/TENANT","gw-1","ttd=${ttd}")  via AMQP messaging network
    activate Application
end

note over Gateway, "Device Connection\nAPI component"
In order for commands to be successfully mapped to the gateway
from here on, the gateway must have acted on behalf of the
command target device (e.g. sent telemetry for it) or it must
be the only gateway associated with the device.
end note

@enduml

PlantUML version 1.2019.11(Sun Sep 22 12:02:15 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.4+11-post-Ubuntu-1ubuntu218.04.3
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>