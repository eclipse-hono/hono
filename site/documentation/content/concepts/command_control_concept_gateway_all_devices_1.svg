<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="543.6px" preserveAspectRatio="none" style="width:1074px;height:543px;" version="1.1" viewBox="0 0 1074 543" width="1074px" zoomAndPan="magnify"><defs><filter height="300%" id="f1jklk7noazmnx" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.4"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.8" dy="4.8" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="518.0625" style="stroke: #A80036; stroke-width: 1.2;" width="410.4" x="274.8" y="4.8"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="457.2" y="19.2803">Hono</text><rect fill="#FFFFFF" filter="url(#f1jklk7noazmnx)" height="178.5563" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="353.4" y="340.7063"/><rect fill="#FFFFFF" filter="url(#f1jklk7noazmnx)" height="19.2" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="987" y="500.0625"/><rect fill="#FFFFFF" filter="url(#f1jklk7noazmnx)" height="316.3125" style="stroke: #000000; stroke-width: 2.4;" width="1041.6" x="19.2" y="193.35"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="136.8" x2="136.8" y1="89.6719" y2="530.0625"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="358.8" x2="358.8" y1="89.6719" y2="530.0625"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="590.4" x2="590.4" y1="89.6719" y2="530.0625"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="777.6" x2="777.6" y1="89.6719" y2="530.0625"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="992.4" x2="992.4" y1="89.6719" y2="530.0625"/><rect fill="#FEFECE" filter="url(#f1jklk7noazmnx)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="87.6" x="91.2" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="70.8" x="99.6" y="71.3098">Gateway</text><rect fill="#FEFECE" filter="url(#f1jklk7noazmnx)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="154.8" x="279.6" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="138" x="288" y="51.7535">Protocol Adapter</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="100.8" x="306.6" y="71.3098">instance #1</text><rect fill="#FEFECE" filter="url(#f1jklk7noazmnx)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="174" x="501.6" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="157.2" x="510" y="51.7535">Device Connection</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="126" x="525.6" y="71.3098">API component</text><rect fill="#FEFECE" filter="url(#f1jklk7noazmnx)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="166.8" x="692.4" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="700.8" y="51.7535">AMQP messaging</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="742.2" y="71.3098">network</text><rect fill="#FEFECE" filter="url(#f1jklk7noazmnx)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="106.8" x="937.2" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="90" x="945.6" y="71.3098">Application</text><rect fill="#FFFFFF" filter="url(#f1jklk7noazmnx)" height="178.5563" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="353.4" y="340.7063"/><rect fill="#FFFFFF" filter="url(#f1jklk7noazmnx)" height="19.2" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="987" y="500.0625"/><path d="M9.6,107.6719 L9.6,173.6719 L260.4,173.6719 L260.4,119.6719 L248.4,107.6719 L9.6,107.6719 " fill="#FBFB77" filter="url(#f1jklk7noazmnx)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M248.4,107.6719 L248.4,119.6719 L260.4,119.6719 L248.4,107.6719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="160.8" x="16.8" y="128.1521">The gateway 'gw-1' is</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="225.6" x="16.8" y="146.3115">connected and authenticated</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="136.8" x="16.8" y="164.4709">with TENANT/gw-1</text><path d="M19.2,193.35 L278.4,193.35 L278.4,201.75 L266.4,213.75 L19.2,213.75 L19.2,193.35 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="316.3125" style="stroke: #000000; stroke-width: 2.4;" width="1041.6" x="19.2" y="193.35"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="205.2" x="37.2" y="209.0303">Command subscription</text><path d="M31.2,219.9094 L31.2,285.9094 L238.8,285.9094 L238.8,231.9094 L226.8,219.9094 L31.2,219.9094 " fill="#FBFB77" filter="url(#f1jklk7noazmnx)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M226.8,219.9094 L226.8,231.9094 L238.8,231.9094 L226.8,219.9094 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="182.4" x="38.4" y="240.3896">The gateway subscribes</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="176.4" x="38.4" y="258.549">to commands just as a</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="156" x="38.4" y="276.7084">normal device would</text><polygon fill="#A80036" points="339,335.9063,351,340.7063,339,345.5062,343.8,340.7063" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="137.4" x2="346.2" y1="340.7063" y2="340.7063"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="145.8" y="325.5475">0</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="177.6" x="161.4" y="316.4678">Command subscription</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="102" x="166.2" y="334.6271">/ TTD request</text><polygon fill="#A80036" points="763.8,370.8656,775.8,375.6656,763.8,380.4656,768.6,375.6656" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="365.4" x2="771" y1="375.6656" y2="375.6656"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="373.8" y="369.5865">1</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="300" x="389.4" y="369.5865">attach("receiver", "command/TENANT")</text><polygon fill="#A80036" points="576.6,460.3031,588.6,465.1031,576.6,469.9031,581.4,465.1031" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="365.4" x2="583.8" y1="465.1031" y2="465.1031"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="373.8" y="431.785">2</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="176.4" x="389.4" y="404.5459">set command handling</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="129.6" x="389.4" y="422.7053">adapter instance</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="122.4" x="389.4" y="440.8646">for device 'gw-1'</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="177.6" x="389.4" y="459.024">to adapter instance #1</text><polygon fill="#A80036" points="972.6,495.2625,984.6,500.0625,972.6,504.8625,977.4,500.0625" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="365.4" x2="979.8" y1="500.0625" y2="500.0625"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="373.8" y="493.9834">3</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="583.2" x="389.4" y="493.9834">transfer("event/TENANT","gw-1","ttd=${ttd}")  via AMQP messaging network</text><!--MD5=[93e2f9ddcc703299e7ec00e54289c11f]
@startuml
scale 1.2
hide footbox

participant Gateway order 20
box "Hono"
    participant "Protocol Adapter\ninstance #1" order 30
    participant "Device Connection\nAPI component" order 50
end box
participant "AMQP messaging \nnetwork" order 60
participant Application order 70

autonumber 0

note over Gateway
The gateway 'gw-1' is
connected and authenticated
with TENANT/gw-1
end note

group Command subscription
    note over Gateway
    The gateway subscribes
    to commands just as a
    normal device would
    end note
    Gateway -> "Protocol Adapter\ninstance #1": Command subscription\n / TTD request
    activate "Protocol Adapter\ninstance #1"

    "Protocol Adapter\ninstance #1" -> "AMQP messaging \nnetwork": attach("receiver", "command/TENANT")
    "Protocol Adapter\ninstance #1" -> "Device Connection\nAPI component": set command handling \nadapter instance \nfor device 'gw-1' \nto adapter instance #1

    "Protocol Adapter\ninstance #1" -> Application: transfer("event/TENANT","gw-1","ttd=${ttd}")  via AMQP messaging network
    activate Application
end

@enduml

PlantUML version 1.2019.11(Sun Sep 22 12:02:15 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.4+11-post-Ubuntu-1ubuntu218.04.3
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>