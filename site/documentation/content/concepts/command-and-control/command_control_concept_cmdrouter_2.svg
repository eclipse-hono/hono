<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="620.4px" preserveAspectRatio="none" style="width:1120px;height:620px;" version="1.1" viewBox="0 0 1120 620" width="1120.8px" zoomAndPan="magnify"><defs><filter height="300%" id="fy2i4od8bk6uu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.4"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.8" dy="4.8" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="594.1406" style="stroke: #A80036; stroke-width: 1.2;" width="349.2" x="201.6" y="4.8"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45.6" x="353.4" y="19.2803">Hono</text><rect fill="#FFFFFF" filter="url(#fy2i4od8bk6uu)" height="118.2375" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="456" y="316.7063"/><rect fill="#FFFFFF" filter="url(#fy2i4od8bk6uu)" height="53.1188" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="822" y="434.9437"/><rect fill="#FFFFFF" filter="url(#fy2i4od8bk6uu)" height="475.6688" style="stroke: #000000; stroke-width: 2.4;" width="1092.6" x="15.6" y="110.0719"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="66" x2="66" y1="89.6719" y2="606.1406"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="285.6" x2="285.6" y1="89.6719" y2="606.1406"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="462" x2="462" y1="89.6719" y2="606.1406"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="827.4" x2="827.4" y1="89.6719" y2="606.1406"/><line style="stroke: #A80036; stroke-width: 1.2; stroke-dasharray: 5.0,5.0;" x1="1039.8" x2="1039.8" y1="89.6719" y2="606.1406"/><rect fill="#FEFECE" filter="url(#fy2i4od8bk6uu)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="73.2" x="27.6" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="56.4" x="36" y="71.3098">Device</text><rect fill="#FEFECE" filter="url(#fy2i4od8bk6uu)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="154.8" x="206.4" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="138" x="214.8" y="51.7535">Protocol Adapter</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="100.8" x="233.4" y="71.3098">instance #1</text><rect fill="#FEFECE" filter="url(#fy2i4od8bk6uu)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="163.2" x="378" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="146.4" x="386.4" y="71.3098">Command Router</text><rect fill="#FEFECE" filter="url(#fy2i4od8bk6uu)" height="55.9125" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="166.8" x="742.2" y="27.7594"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="750.6" y="51.7535">AMQP messaging</text><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="67.2" x="792" y="71.3098">network</text><rect fill="#FEFECE" filter="url(#fy2i4od8bk6uu)" height="36.3562" style="stroke: #A80036; stroke-width: 1.7999999999999998;" width="106.8" x="984.6" y="47.3156"/><text fill="#000000" font-family="sans-serif" font-size="16.8" lengthAdjust="spacingAndGlyphs" textLength="90" x="993" y="71.3098">Application</text><rect fill="#FFFFFF" filter="url(#fy2i4od8bk6uu)" height="118.2375" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="456" y="316.7063"/><rect fill="#FFFFFF" filter="url(#fy2i4od8bk6uu)" height="53.1188" style="stroke: #A80036; stroke-width: 1.2;" width="12" x="822" y="434.9437"/><path d="M15.6,110.0719 L242.4,110.0719 L242.4,118.4719 L230.4,130.4719 L15.6,130.4719 L15.6,110.0719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.2;"/><rect fill="none" height="475.6688" style="stroke: #000000; stroke-width: 2.4;" width="1092.6" x="15.6" y="110.0719"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172.8" x="33.6" y="125.7521">Command handling</text><polygon fill="#A80036" points="841.2,187.5094,829.2,192.3094,841.2,197.1094,836.4,192.3094" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="834" x2="1039.2" y1="192.3094" y2="192.3094"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="848.4" y="168.0709">1</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="133.2" x="864" y="149.9115">attach("receiver",</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="168" x="864" y="168.0709">"command_response/</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="157.2" x="868.8" y="186.2303">TENANT/${replyId}")</text><polygon fill="#A80036" points="841.2,240.6281,829.2,245.4281,841.2,250.2281,836.4,245.4281" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="834" x2="1039.2" y1="245.4281" y2="245.4281"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="848.4" y="230.2693">2</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="124.8" x="864" y="221.1896">attach("sender",</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="162" x="864" y="239.349">"command/TENANT")</text><polygon fill="#A80036" points="481.2,311.9063,469.2,316.7063,481.2,321.5062,476.4,316.7063" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="474" x2="1039.2" y1="316.7063" y2="316.7063"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="488.4" y="292.4678">3</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="226.8" x="504" y="274.3084">transfer("command/TENANT",</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="310.8" x="508.8" y="292.4678">"command/TENANT/4711","${payload}")</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="225.6" x="518.4" y="310.6271">via AMQP messaging network</text><path d="M319.2,332.3063 L319.2,380.3063 L600,380.3063 L600,344.3063 L588,332.3063 L319.2,332.3063 " fill="#FBFB77" filter="url(#fy2i4od8bk6uu)" style="stroke: #A80036; stroke-width: 1.2;"/><path d="M588,332.3063 L588,344.3063 L600,344.3063 L588,332.3063 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.2;"/><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="255.6" x="326.4" y="352.7865">Determine adapter instance "#1"</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="236.4" x="326.4" y="370.9459">handling commands for "4711"</text><polygon fill="#A80036" points="807.6,430.1438,819.6,434.9437,807.6,439.7438,812.4,434.9437" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="462" x2="814.8" y1="434.9437" y2="434.9437"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="470.4" y="419.785">4</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="254.4" x="486" y="410.7053">transfer("command_internal/#1",</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="310.8" x="490.8" y="428.8646">"command/TENANT/4711","${payload}")</text><polygon fill="#A80036" points="299.4,483.2625,287.4,488.0625,299.4,492.8625,294.6,488.0625" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="292.2" x2="826.8" y1="488.0625" y2="488.0625"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="306.6" y="472.9037">5</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="254.4" x="322.2" y="463.824">transfer("command_internal/#1",</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="310.8" x="327" y="481.9834">"command/TENANT/4711","${payload}")</text><polygon fill="#A80036" points="79.8,518.2219,67.8,523.0219,79.8,527.8219,75,523.0219" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="72.6" x2="285" y1="523.0219" y2="523.0219"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="87" y="516.9428">6</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="175.2" x="102.6" y="516.9428">Command is published</text><polygon fill="#A80036" points="1026,571.3406,1038,576.1406,1026,580.9406,1030.8,576.1406" style="stroke: #A80036; stroke-width: 1.2;"/><line style="stroke: #A80036; stroke-width: 1.2;" x1="286.2" x2="1033.2" y1="576.1406" y2="576.1406"/><text fill="#000000" font-family="sans-serif" font-size="15.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="10.8" x="294.6" y="560.9818">7</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="176.4" x="310.2" y="551.9021">disposition("accepted")</text><text fill="#000000" font-family="sans-serif" font-size="15.6" lengthAdjust="spacingAndGlyphs" textLength="399.6" x="310.2" y="570.0615">via Command Router and AMQP messaging network</text><!--MD5=[914447e975d589e6bb616795754f2144]
@startuml
scale 1.2
hide footbox

participant Device order 10
box "Hono"
    participant "Protocol Adapter\ninstance #1" order 30
    participant "Command Router" order 40
end box
participant "AMQP messaging \nnetwork" order 60
participant Application order 70

autonumber

group Command handling

    Application -> "AMQP messaging \nnetwork": attach("receiver", \n"command_response/\n TENANT/${replyId}")
    Application -> "AMQP messaging \nnetwork": attach("sender", \n"command/TENANT")

    Application -> "Command Router": transfer("command/TENANT",\n "command/TENANT/4711","${payload}")\n   via AMQP messaging network
    activate "Command Router"

    note over "Command Router"
    Determine adapter instance "#1"
    handling commands for "4711"
    end note

    "Command Router" -> "AMQP messaging \nnetwork": transfer("command_internal/#1",\n "command/TENANT/4711","${payload}")
    deactivate "Command Router"
    activate "AMQP messaging \nnetwork"
    "AMQP messaging \nnetwork" -> "Protocol Adapter\ninstance #1": transfer("command_internal/#1",\n "command/TENANT/4711","${payload}")
    deactivate "AMQP messaging \nnetwork"

    "Protocol Adapter\ninstance #1" -> Device: Command is published
    "Protocol Adapter\ninstance #1" -> Application: disposition("accepted") \nvia Command Router and AMQP messaging network
end
@enduml

PlantUML version 1.2019.11(Sun Sep 22 12:02:15 CEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.9.1+1-Ubuntu-0ubuntu1.18.04
Operating System: Linux
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>